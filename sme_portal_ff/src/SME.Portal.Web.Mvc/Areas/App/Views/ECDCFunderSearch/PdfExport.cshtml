@using SME.Portal.Web.Areas.App.Models.FSS;
@using SME.Portal.Web.Areas.App.Models.FunderSearch;
@using SME.Portal.UiCustomization.Dto
@using SME.Portal.Common.Dto;
@using CultureHelper = SME.Portal.Localization.CultureHelper
@using SME.Portal.Web.Areas.App.Models.Common.ListItems;

@model FunderSearchSummaryViewModel

@{
    Layout = null;
    UiCustomizationSettingsDto theme = await GetTheme();
    //var applicationProperties = NameValuePairDto.FromJson(Model.Application.MatchCriteriaJson).ToList();
    //var appPropDict = new Dictionary<int, List<NameValuePairDto>>();
    //appPropDict.Add(Model.Application.Id, applicationProperties);

}

<!DOCTYPE html>
<html lang="en" dir=@(CultureHelper.IsRtl ? "rtl" : "")>

<head>
    <meta charset="utf-8" />

    <title>ECDC - Funder Search Summary</title>

    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />

    @* Fill these meta tags upon your project specification *@
    <meta content="Portal" name="description" />
    <meta content="Portal" name="keywords" />
    <meta content="Portal" name="author" />

    <link rel="shortcut icon" href="~/favicon.ico" />

    <link rel="stylesheet" abp-href="/view-resources/Areas/App/Views/_Bundles/vendors.bundle.css" asp-append-version="true" />
    <link rel="stylesheet" href="@(ApplicationPath)metronic/themes/default/css/style.bundle@(CultureHelper.IsRtl ? ".rtl":"").css" asp-append-version="true" />
    <link rel="stylesheet" abp-href="/view-resources/Areas/App/Views/_Bundles/common-styles.css" asp-append-version="true" />

    @if(CultureHelper.IsRtl)
    {
        <link rel="stylesheet" href="/Common/Styles/abp-zero-template-rtl.css" asp-append-version="true" />
    }

    <script type="text/javascript">
        @* This is used to get the application's root path from javascript.
        It's useful if you're running application in a virtual directory under IIS. *@
        var abp = abp || {}; abp.appPath = '@ApplicationPath';
    </script>

    @{
        await Html.RenderPartialAsync(
            "../Common/_ListItemsPartial.cshtml",
            new ListItemsViewModel()
            {
                ListItems = Model.ListItems,
                Tenant = "ecdc"
            }
        );
    }

    <environment include="Development">
        <script src="https://code.jquery.com/jquery-3.6.0.js"
                integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
                crossorigin="anonymous"></script>

        <script src="~/view-resources/Areas/App/Views/Common/industry-sector-buddy.js" asp-append-version="true"></script>
        <script src="~/view-resources//Areas//App/Views/SefaSme/helpers.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/Common/html-control.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/Common/sme-common.js" asp-append-version="true"></script>

        <script src="~/view-resources/Areas/App/Views/SefaApp/wizard-common.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/Application/ecdc/app-common.js" asp-append-version="true"></script>

        <script src="~/view-resources/Areas/App/Views/Application/ecdc/FundingRequirements/dto.js" asp-append-version="true"></script>

        <script src="~/view-resources/Areas/App/Views/Application/Common/CompanyInfo/dto.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/Application/ecdc/CompanyInfo/dto.js" asp-append-version="true"></script>

        <script src="~/view-resources/Areas/App/Views/Application/ecdc/FinancialInfo/dto.js" asp-append-version="true"></script>

        <script src="~/view-resources/Areas/App/Views/BasicScreening/Common/UserProfile/summary.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/BasicScreening/Common/OwnerProfile/summary.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/BasicScreening/Common/CompanyProfile/summary.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/BasicScreening/ECDC/CompanyProfile/summary.js" asp-append-version="true"></script>

        <script src="~/view-resources/Areas/App/Views/Application/ecdc/FundingRequirements/summary.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/Application/ecdc/ProductMatching/summary.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/Application/ecdc/CompanyInfo/summary.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/Application/ecdc/FinancialInfo/summary.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/Application/ecdc/MinRequirements/summary.js" asp-append-version="true"></script>

    </environment>

    <environment include="Production, Staging">
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="~/view-resources/Areas/App/Views/Common/industry-sector-buddy.min.js" asp-append-version="true"></script>
        <script src="~/view-resources//Areas//App/Views/SefaSme/helpers.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/Common/html-control.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/Common/sme-common.min.js" asp-append-version="true"></script>

        <script src="~/view-resources/Areas/App/Views/SefaApp/wizard-common.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/Application/ecdc/app-common.min.js" asp-append-version="true"></script>

        <script src="~/view-resources/Areas/App/Views/Application/ecdc/FundingRequirements/dto.min.js" asp-append-version="true"></script>

        <script src="~/view-resources/Areas/App/Views/Application/Common/CompanyInfo/dto.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/Application/ecdc/CompanyInfo/dto.min.js" asp-append-version="true"></script>

        <script src="~/view-resources/Areas/App/Views/Application/ecdc/FinancialInfo/dto.min.js" asp-append-version="true"></script>

        <script src="~/view-resources/Areas/App/Views/BasicScreening/Common/UserProfile/summary.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/BasicScreening/Common/OwnerProfile/summary.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/BasicScreening/Common/CompanyProfile/summary.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/BasicScreening/ECDC/CompanyProfile/summary.min.js" asp-append-version="true"></script>

        <script src="~/view-resources/Areas/App/Views/Application/ecdc/FundingRequirements/summary.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/Application/ecdc/ProductMatching/summary.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/Application/ecdc/CompanyInfo/summary.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/Application/ecdc/FinancialInfo/summary.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Areas/App/Views/Application/ecdc/MinRequirements/summary.min.js" asp-append-version="true"></script>
    </environment>

    <script type="text/javascript">

        $(document).ready(function () {
            app.wizard.isb.init(null, null, null);
            let json = @Html.Raw(Json.Serialize(Model));

            let helpers = app.onboard.helpers.get();
            let appId = json.application.id;

            app.fss.user.render(json.settings, appId);
            app.fss.owner.render(json.ownerProfile, appId);
            app.fss.company.render(json.smeCompany, appId);
            let mc = JSON.parse(json.application.matchCriteriaJson);
            let dto = helpers.nvpArrayToObject(mc);
            //
            app.wizard.fundingRequirements.summary.render(dto, appId);
            app.wizard.productMatching.summary.render(dto, appId);
            app.wizard.companyInfo.summary.render(dto, appId);
            app.wizard.financialInfo.summary.render(dto, appId);
            app.wizard.keyThings.summary.render(dto, json.smeCompany.id, appId, null, false);

            window.setTimeout(function () {
                $('#id-funder-search-matches-detail-div').fadeIn(500, 'swing', function () {
                });
            }, 10);
        });

    </script>

</head>

<body>

    <div class="d-flex flex-column flex-root" id="id-funder-search-matches-detail-div">
        <div class="card card-custom gutter-b">
            <div class="card-body">
                @{
                    var fssVM = new FSSViewModel()
                    {
                        StyleWidth = "width:55%;",
                        StyleCol = "",
                        ApplicationId = Model.Application.Id,
                        TenantId = 0,
                        HeaderColor = "#099ba0"
                    };
                    
                    await Html.RenderPartialAsync("../BasicScreening/ECDC/UserProfile/summary.cshtml", fssVM);
                    await Html.RenderPartialAsync("../BasicScreening/ECDC/OwnerProfile/summary.cshtml", fssVM);
                    await Html.RenderPartialAsync("../BasicScreening/ECDC/CompanyProfile/summary.cshtml", fssVM);
                    await Html.RenderPartialAsync("../Application/ECDC/FundingRequirements/summary.cshtml", fssVM);
                    await Html.RenderPartialAsync("../Application/ECDC/ProductMatching/summary.cshtml", fssVM);
                    await Html.RenderPartialAsync("../Application/ECDC/CompanyInfo/summary.cshtml", fssVM);
                    await Html.RenderPartialAsync("../Application/ECDC/FinancialInfo/summary.cshtml", fssVM);
                    await Html.RenderPartialAsync("../Application/ECDC/MinRequirements/summary.cshtml", fssVM);
                }
            </div>
        </div>
    </div>

</body>

</html>
